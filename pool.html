<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pool of Radiance (1988) | HTML Recreation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background-color: #000;
            color: #fff;
            line-height: 1.4;
            padding: 10px;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            font-size: 16px;
        }
        
        /* Atari 80s-style font */
        @font-face {
            font-family: 'Atari Classic';
            src: url('https://fonts.cdnfonts.com/s/13009/AtariClassicChunky-PxXP.woff') format('woff');
        }
        
        .container {
            display: flex;
            flex-direction: column;
            height: 100%;
            border: 2px solid #ccc;
            padding: 5px;
            background-color: #000;
        }
        
        .header {
            text-align: center;
            border-bottom: 2px solid #ccc;
            padding-bottom: 5px;
            margin-bottom: 10px;
            font-family: 'Atari Classic', 'Courier New', monospace;
            font-size: 1.8em;
            color: #fff;
            text-shadow: 0 0 5px #0ff;
        }
        
        .game-area {
            display: flex;
            flex: 1;
            min-height: 0;
        }
        
        .main-screen {
            flex: 3;
            border: 1px solid #ccc;
            padding: 10px;
            margin-right: 10px;
            overflow-y: auto;
            background-color: #111;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .side-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 250px;
        }
        
        .character-panel {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #111;
            font-size: 12px;
        }
        
        .controls-panel {
            border: 1px solid #ccc;
            padding: 10px;
            background-color: #111;
            flex: 1;
        }
        
        .screen-title {
            font-family: 'Atari Classic', 'Courier New', monospace;
            color: #0ff;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.4em;
        }
        
        .status-line {
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
            margin-bottom: 10px;
            color: #0f0;
        }
        
        .command-line {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #444;
        }
        
        .prompt {
            color: #0ff;
            margin-right: 5px;
        }
        
        .input-line {
            display: flex;
            align-items: center;
        }
        
        input[type="text"] {
            background: transparent;
            border: none;
            color: #fff;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            flex: 1;
            outline: none;
            padding: 5px;
        }
        
        input[type="text"]:focus {
            background-color: #222;
        }
        
        .button {
            background-color: #333;
            color: #fff;
            border: 1px solid #666;
            padding: 5px 10px;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 2px;
            transition: all 0.2s;
        }
        
        .button:hover {
            background-color: #555;
            border-color: #0ff;
        }
        
        .button:active {
            background-color: #777;
        }
        
        .button-row {
            display: flex;
            flex-wrap: wrap;
            margin-top: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            margin-top: 10px;
        }
        
        .stat {
            display: flex;
            justify-content: space-between;
            border-bottom: 1px dotted #444;
        }
        
        .stat-name {
            color: #0ff;
        }
        
        .stat-value {
            color: #ff0;
        }
        
        .combat-log {
            height: 150px;
            overflow-y: auto;
            border: 1px solid #333;
            padding: 5px;
            margin-top: 10px;
            background-color: #000;
            font-size: 12px;
        }
        
        .log-entry {
            margin-bottom: 3px;
        }
        
        .log-combat {
            color: #f00;
        }
        
        .log-damage {
            color: #ff0;
        }
        
        .log-heal {
            color: #0f0;
        }
        
        .log-info {
            color: #0ff;
        }
        
        .location {
            color: #ff0;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .game-text {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .enemy {
            color: #f00;
        }
        
        .ally {
            color: #0f0;
        }
        
        .menu {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-top: 10px;
        }
        
        .menu-item {
            padding: 5px;
            border: 1px solid #333;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .menu-item:hover {
            background-color: #222;
            border-color: #0ff;
        }
        
        .character-sheet {
            display: none;
            margin-top: 10px;
            border: 1px solid #444;
            padding: 10px;
        }
        
        .inventory {
            display: none;
            margin-top: 10px;
            border: 1px solid #444;
            padding: 10px;
        }
        
        .combat-screen {
            display: none;
        }
        
        .combatants {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .combatant {
            text-align: center;
            padding: 10px;
            border: 1px solid #333;
            width: 120px;
        }
        
        .player-combatant {
            border-color: #0f0;
        }
        
        .enemy-combatant {
            border-color: #f00;
        }
        
        .health-bar {
            width: 100%;
            height: 10px;
            background-color: #333;
            margin-top: 5px;
            position: relative;
        }
        
        .health-fill {
            height: 100%;
            background-color: #0f0;
            transition: width 0.5s;
        }
        
        .combat-actions {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 20px;
        }
        
        .footer {
            text-align: center;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 1px solid #444;
            font-size: 12px;
            color: #666;
        }
        
        /* Screen transitions */
        .active-screen {
            display: block !important;
        }
        
        /* Blinking cursor effect */
        .cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background-color: #fff;
            animation: blink 1s infinite;
            vertical-align: middle;
            margin-left: 2px;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #111;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #333;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">POOL OF RADIANCE (1988)</div>
        
        <div class="game-area">
            <div class="main-screen">
                <!-- Start Screen -->
                <div id="start-screen" class="active-screen">
                    <div class="screen-title">POOL OF RADIANCE</div>
                    <div class="game-text">
                        <p>Welcome to the ruins of Phlan, a city torn asunder by evil forces.</p>
                        <p>Once a thriving metropolis, Phlan now lies in ruins, its streets haunted by monsters and its treasures guarded by dark magic.</p>
                        <p>The fabled Pool of Radiance, source of the city's former glory, has been corrupted. You have been summoned by the Council of Phlan to cleanse the city and restore the Pool to its former state.</p>
                        <p>Your quest begins now...</p>
                    </div>
                    <div class="menu">
                        <div class="menu-item" id="new-game-btn">BEGIN NEW ADVENTURE</div>
                        <div class="menu-item" id="load-game-btn">CONTINUE SAVED GAME</div>
                        <div class="menu-item" id="about-btn">ABOUT THE GAME</div>
                    </div>
                </div>
                
                <!-- Character Creation Screen -->
                <div id="char-creation-screen">
                    <div class="screen-title">CHARACTER CREATION</div>
                    <div class="game-text">
                        <p>Create your character to begin your adventure.</p>
                        <p>You will need to choose a class, assign ability scores, and select a race.</p>
                    </div>
                    <div id="char-creation-form">
                        <div class="stats">
                            <div class="stat">
                                <span class="stat-name">Name:</span>
                                <span class="stat-value" id="char-name">Valeros</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Race:</span>
                                <span class="stat-value" id="char-race">Human</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Class:</span>
                                <span class="stat-value" id="char-class">Fighter</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Level:</span>
                                <span class="stat-value" id="char-level">1</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">HP:</span>
                                <span class="stat-value" id="char-hp">10/10</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">AC:</span>
                                <span class="stat-value" id="char-ac">5</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">STR:</span>
                                <span class="stat-value" id="char-str">16</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">DEX:</span>
                                <span class="stat-value" id="char-dex">12</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">CON:</span>
                                <span class="stat-value" id="char-con">14</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">INT:</span>
                                <span class="stat-value" id="char-int">10</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">WIS:</span>
                                <span class="stat-value" id="char-wis">8</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">CHA:</span>
                                <span class="stat-value" id="char-cha">13</span>
                            </div>
                        </div>
                        
                        <div class="button-row">
                            <button class="button" id="change-name-btn">CHANGE NAME</button>
                            <button class="button" id="change-race-btn">CHANGE RACE</button>
                            <button class="button" id="change-class-btn">CHANGE CLASS</button>
                            <button class="button" id="reroll-stats-btn">REROLL STATS</button>
                            <button class="button" id="complete-char-btn">BEGIN ADVENTURE</button>
                        </div>
                    </div>
                </div>
                
                <!-- Game Screen -->
                <div id="game-screen">
                    <div class="location" id="current-location">OUTSIDE THE CITY GATES</div>
                    <div class="game-text" id="location-description">
                        You stand before the ruined gates of Phlan. The once-mighty walls are now crumbling, and the portcullis hangs broken from its chains. The air carries the scent of decay and distant smoke. The path ahead leads into the city proper, where danger and treasure await.
                    </div>
                    <div class="game-text" id="game-messages">
                        <p>You see the following exits: North (into the city), East (along the wall), West (toward the river).</p>
                        <p>A rusted sign near the gate reads: "Beware all who enter. The monsters within show no mercy."</p>
                    </div>
                    
                    <!-- Character Sheet -->
                    <div class="character-sheet" id="char-sheet">
                        <div class="screen-title">CHARACTER SHEET</div>
                        <div class="stats">
                            <div class="stat">
                                <span class="stat-name">Name:</span>
                                <span class="stat-value">Valeros</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Race:</span>
                                <span class="stat-value">Human</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Class:</span>
                                <span class="stat-value">Fighter</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Level:</span>
                                <span class="stat-value">1</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">XP:</span>
                                <span class="stat-value">0/1000</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">HP:</span>
                                <span class="stat-value">10/10</span>
                            </div>
                            <div class="stat">
                                <span class="stat-name">Gold:</span>
                                <span class="stat-value">10</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Inventory -->
                    <div class="inventory" id="inventory">
                        <div class="screen-title">INVENTORY</div>
                        <div class="game-text">
                            <p>Long Sword (equipped)</p>
                            <p>Leather Armor (equipped)</p>
                            <p>Small Shield (equipped)</p>
                            <p>Healing Potion (2)</p>
                            <p>Torch (3)</p>
                            <p>Rations (5)</p>
                            <p>Rope (50 ft)</p>
                        </div>
                    </div>
                    
                    <!-- Combat Screen -->
                    <div class="combat-screen" id="combat-screen">
                        <div class="screen-title">COMBAT!</div>
                        <div class="game-text">You are attacked by monsters!</div>
                        
                        <div class="combatants">
                            <div class="combatant player-combatant">
                                <div>Valeros</div>
                                <div>HP: <span id="player-hp">10</span>/10</div>
                                <div class="health-bar">
                                    <div class="health-fill" id="player-health-bar" style="width: 100%"></div>
                                </div>
                                <div>Fighter Lvl 1</div>
                            </div>
                            
                            <div class="combatant enemy-combatant">
                                <div>Goblin</div>
                                <div>HP: <span id="enemy-hp">6</span>/6</div>
                                <div class="health-bar">
                                    <div class="health-fill" id="enemy-health-bar" style="width: 100%"></div>
                                </div>
                                <div>Enemy</div>
                            </div>
                        </div>
                        
                        <div class="combat-log" id="combat-log">
                            <div class="log-entry log-combat">Combat started! A goblin attacks!</div>
                        </div>
                        
                        <div class="combat-actions">
                            <button class="button" id="attack-btn">ATTACK</button>
                            <button class="button" id="cast-spell-btn">CAST SPELL</button>
                            <button class="button" id="use-item-btn">USE ITEM</button>
                            <button class="button" id="flee-btn">FLEE</button>
                        </div>
                    </div>
                </div>
                
                <!-- About Screen -->
                <div id="about-screen">
                    <div class="screen-title">ABOUT POOL OF RADIANCE</div>
                    <div class="game-text">
                        <p>Pool of Radiance was the first Advanced Dungeons & Dragons computer role-playing game, released in 1988 by Strategic Simulations, Inc.</p>
                        <p>The game is set in the Forgotten Realms campaign setting, in the ruined city of Phlan. Players create a party of adventurers to explore the city, fight monsters, complete quests, and ultimately cleanse the corrupted Pool of Radiance.</p>
                        <p>This HTML recreation captures the look and feel of the original 1988 computer game, with its monochrome display, command-based interface, and turn-based combat system.</p>
                        <p>Original game by SSI. Recreation for educational purposes only.</p>
                    </div>
                    <div class="button-row">
                        <button class="button" id="back-from-about-btn">RETURN TO MAIN MENU</button>
                    </div>
                </div>
            </div>
            
            <div class="side-panel">
                <div class="character-panel">
                    <div class="screen-title">ADVENTURER</div>
                    <div class="status-line">
                        <div>Valeros - Human Fighter</div>
                        <div>Level: 1 | HP: 10/10</div>
                        <div>XP: 0/1000 | Gold: 10</div>
                    </div>
                    
                    <div class="stats">
                        <div class="stat">
                            <span class="stat-name">STR:</span>
                            <span class="stat-value">16</span>
                        </div>
                        <div class="stat">
                            <span class="stat-name">DEX:</span>
                            <span class="stat-value">12</span>
                        </div>
                        <div class="stat">
                            <span class="stat-name">CON:</span>
                            <span class="stat-value">14</span>
                        </div>
                        <div class="stat">
                            <span class="stat-name">INT:</span>
                            <span class="stat-value">10</span>
                        </div>
                        <div class="stat">
                            <span class="stat-name">WIS:</span>
                            <span class="stat-value">8</span>
                        </div>
                        <div class="stat">
                            <span class="stat-name">CHA:</span>
                            <span class="stat-value">13</span>
                        </div>
                    </div>
                    
                    <div class="button-row">
                        <button class="button" id="char-sheet-btn">CHAR SHEET</button>
                        <button class="button" id="inventory-btn">INVENTORY</button>
                    </div>
                </div>
                
                <div class="controls-panel">
                    <div class="screen-title">COMMANDS</div>
                    <div class="button-row">
                        <button class="button" id="north-btn">NORTH</button>
                        <button class="button" id="south-btn">SOUTH</button>
                        <button class="button" id="east-btn">EAST</button>
                        <button class="button" id="west-btn">WEST</button>
                    </div>
                    <div class="button-row">
                        <button class="button" id="search-btn">SEARCH</button>
                        <button class="button" id="rest-btn">REST</button>
                        <button class="button" id="map-btn">MAP</button>
                        <button class="button" id="save-btn">SAVE</button>
                    </div>
                    
                    <div class="command-line">
                        <div class="input-line">
                            <span class="prompt">&gt;</span>
                            <input type="text" id="command-input" placeholder="Type command...">
                            <div class="cursor"></div>
                        </div>
                    </div>
                    
                    <div class="combat-log" id="event-log">
                        <div class="log-entry log-info">Welcome to Pool of Radiance!</div>
                        <div class="log-entry log-info">Type a command or use buttons.</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            POOL OF RADIANCE (1988) - HTML Recreation | Use buttons or type commands like: GO NORTH, ATTACK, SEARCH, REST
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            currentScreen: 'start',
            player: {
                name: 'Valeros',
                race: 'Human',
                class: 'Fighter',
                level: 1,
                hp: 10,
                maxHp: 10,
                ac: 5,
                str: 16,
                dex: 12,
                con: 14,
                int: 10,
                wis: 8,
                cha: 13,
                xp: 0,
                xpNeeded: 1000,
                gold: 10,
                inventory: [
                    'Long Sword (equipped)',
                    'Leather Armor (equipped)',
                    'Small Shield (equipped)',
                    'Healing Potion (2)',
                    'Torch (3)',
                    'Rations (5)',
                    'Rope (50 ft)'
                ]
            },
            currentLocation: 'OUTSIDE THE CITY GATES',
            inCombat: false,
            combatEnemy: {
                name: 'Goblin',
                hp: 6,
                maxHp: 6,
                damage: '1d6'
            },
            locations: {
                'OUTSIDE THE CITY GATES': {
                    description: 'You stand before the ruined gates of Phlan. The once-mighty walls are now crumbling, and the portcullis hangs broken from its chains.',
                    exits: {
                        north: 'MARKET SQUARE',
                        east: 'EAST WALL',
                        west: 'RIVERFRONT'
                    },
                    message: 'A rusted sign near the gate reads: "Beware all who enter. The monsters within show no mercy."'
                },
                'MARKET SQUARE': {
                    description: 'The once-bustling market square is now littered with debris and abandoned stalls. The fountain in the center is dry and cracked.',
                    exits: {
                        south: 'OUTSIDE THE CITY GATES',
                        east: 'TEMPLE DISTRICT',
                        west: 'RESIDENTIAL QUARTER'
                    },
                    message: 'You hear skittering noises from the shadows. Something is watching you.'
                },
                'TEMPLE DISTRICT': {
                    description: 'The spires of several temples rise above the ruins, though most are damaged. A faint chanting can be heard from somewhere nearby.',
                    exits: {
                        west: 'MARKET SQUARE',
                        north: 'POOL OF RADIANCE'
                    },
                    message: 'A sense of divine energy lingers here, though it feels corrupted.'
                }
            }
        };

        // DOM elements
        const screens = {
            start: document.getElementById('start-screen'),
            charCreation: document.getElementById('char-creation-screen'),
            game: document.getElementById('game-screen'),
            about: document.getElementById('about-screen')
        };
        
        const commandInput = document.getElementById('command-input');
        const eventLog = document.getElementById('event-log');
        const combatLog = document.getElementById('combat-log');
        
        // Initialize the game
        function initGame() {
            // Set up event listeners for buttons
            document.getElementById('new-game-btn').addEventListener('click', showCharCreation);
            document.getElementById('load-game-btn').addEventListener('click', loadGame);
            document.getElementById('about-btn').addEventListener('click', showAbout);
            document.getElementById('back-from-about-btn').addEventListener('click', showStartScreen);
            
            // Character creation buttons
            document.getElementById('change-name-btn').addEventListener('click', changeCharacterName);
            document.getElementById('change-race-btn').addEventListener('click', changeCharacterRace);
            document.getElementById('change-class-btn').addEventListener('click', changeCharacterClass);
            document.getElementById('reroll-stats-btn').addEventListener('click', rerollStats);
            document.getElementById('complete-char-btn').addEventListener('click', completeCharacter);
            
            // Game control buttons
            document.getElementById('char-sheet-btn').addEventListener('click', toggleCharSheet);
            document.getElementById('inventory-btn').addEventListener('click', toggleInventory);
            
            // Movement buttons
            document.getElementById('north-btn').addEventListener('click', () => move('north'));
            document.getElementById('south-btn').addEventListener('click', () => move('south'));
            document.getElementById('east-btn').addEventListener('click', () => move('east'));
            document.getElementById('west-btn').addEventListener('click', () => move('west'));
            
            // Action buttons
            document.getElementById('search-btn').addEventListener('click', searchArea);
            document.getElementById('rest-btn').addEventListener('click', rest);
            document.getElementById('map-btn').addEventListener('click', showMap);
            document.getElementById('save-btn').addEventListener('click', saveGame);
            
            // Combat buttons
            document.getElementById('attack-btn').addEventListener('click', attackEnemy);
            document.getElementById('cast-spell-btn').addEventListener('click', castSpell);
            document.getElementById('use-item-btn').addEventListener('click', useItem);
            document.getElementById('flee-btn').addEventListener('click', fleeCombat);
            
            // Command input
            commandInput.addEventListener('keypress', handleCommandInput);
            
            // Set initial screen
            showStartScreen();
            
            // Add initial log entry
            addLogEntry('Welcome to the ruins of Phlan. Type HELP for available commands.', 'info');
        }
        
        // Screen management functions
        function showScreen(screenName) {
            // Hide all screens
            Object.values(screens).forEach(screen => {
                screen.classList.remove('active-screen');
            });
            
            // Show the requested screen
            screens[screenName].classList.add('active-screen');
            gameState.currentScreen = screenName;
            
            // Clear command input
            commandInput.value = '';
            
            // Focus on command input if on game screen
            if (screenName === 'game') {
                commandInput.focus();
            }
        }
        
        function showStartScreen() {
            showScreen('start');
        }
        
        function showCharCreation() {
            showScreen('charCreation');
            updateCharCreationDisplay();
        }
        
        function showGameScreen() {
            showScreen('game');
            updateLocationDisplay();
        }
        
        function showAbout() {
            showScreen('about');
        }
        
        // Character creation functions
        function updateCharCreationDisplay() {
            document.getElementById('char-name').textContent = gameState.player.name;
            document.getElementById('char-race').textContent = gameState.player.race;
            document.getElementById('char-class').textContent = gameState.player.class;
            document.getElementById('char-level').textContent = gameState.player.level;
            document.getElementById('char-hp').textContent = `${gameState.player.hp}/${gameState.player.maxHp}`;
            document.getElementById('char-ac').textContent = gameState.player.ac;
            document.getElementById('char-str').textContent = gameState.player.str;
            document.getElementById('char-dex').textContent = gameState.player.dex;
            document.getElementById('char-con').textContent = gameState.player.con;
            document.getElementById('char-int').textContent = gameState.player.int;
            document.getElementById('char-wis').textContent = gameState.player.wis;
            document.getElementById('char-cha').textContent = gameState.player.cha;
        }
        
        function changeCharacterName() {
            const newName = prompt('Enter your character name:', gameState.player.name);
            if (newName && newName.trim() !== '') {
                gameState.player.name = newName.trim();
                updateCharCreationDisplay();
                addLogEntry(`Character name changed to ${gameState.player.name}`, 'info');
            }
        }
        
        function changeCharacterRace() {
            const races = ['Human', 'Elf', 'Dwarf', 'Halfling', 'Half-Elf', 'Gnome'];
            const currentIndex = races.indexOf(gameState.player.race);
            const nextIndex = (currentIndex + 1) % races.length;
            gameState.player.race = races[nextIndex];
            updateCharCreationDisplay();
            addLogEntry(`Race changed to ${gameState.player.race}`, 'info');
        }
        
        function changeCharacterClass() {
            const classes = ['Fighter', 'Cleric', 'Magic-User', 'Thief', 'Ranger', 'Paladin'];
            const currentIndex = classes.indexOf(gameState.player.class);
            const nextIndex = (currentIndex + 1) % classes.length;
            gameState.player.class = classes[nextIndex];
            updateCharCreationDisplay();
            addLogEntry(`Class changed to ${gameState.player.class}`, 'info');
        }
        
        function rerollStats() {
            gameState.player.str = Math.floor(Math.random() * 6) + 8 + Math.floor(Math.random() * 6);
            gameState.player.dex = Math.floor(Math.random() * 6) + 8 + Math.floor(Math.random() * 6);
            gameState.player.con = Math.floor(Math.random() * 6) + 8 + Math.floor(Math.random() * 6);
            gameState.player.int = Math.floor(Math.random() * 6) + 8 + Math.floor(Math.random() * 6);
            gameState.player.wis = Math.floor(Math.random() * 6) + 8 + Math.floor(Math.random() * 6);
            gameState.player.cha = Math.floor(Math.random() * 6) + 8 + Math.floor(Math.random() * 6);
            
            updateCharCreationDisplay();
            addLogEntry('Ability scores rerolled!', 'info');
        }
        
        function completeCharacter() {
            addLogEntry(`Welcome, ${gameState.player.name} the ${gameState.player.race} ${gameState.player.class}!`, 'info');
            showGameScreen();
        }
        
        // Game functions
        function updateLocationDisplay() {
            const location = gameState.locations[gameState.currentLocation];
            if (location) {
                document.getElementById('current-location').textContent = gameState.currentLocation;
                document.getElementById('location-description').textContent = location.description;
                document.getElementById('game-messages').innerHTML = `<p>You see the following exits: ${Object.keys(location.exits).map(dir => `${dir.toUpperCase()} (${location.exits[dir]})`).join(', ')}.</p><p>${location.message}</p>`;
            }
        }
        
        function move(direction) {
            if (gameState.inCombat) {
                addLogEntry('You cannot move while in combat!', 'info');
                return;
            }
            
            const location = gameState.locations[gameState.currentLocation];
            if (location && location.exits[direction]) {
                gameState.currentLocation = location.exits[direction];
                updateLocationDisplay();
                addLogEntry(`You move ${direction.toUpperCase()} to ${gameState.currentLocation}.`, 'info');
                
                // Random encounter chance
                if (Math.random() < 0.3) {
                    startCombat();
                }
            } else {
                addLogEntry(`You cannot go ${direction.toUpperCase()} from here.`, 'info');
            }
        }
        
        function searchArea() {
            if (gameState.inCombat) {
                addLogEntry('You cannot search while in combat!', 'info');
                return;
            }
            
            const foundGold = Math.floor(Math.random() * 10) + 1;
            gameState.player.gold += foundGold;
            addLogEntry(`You search the area and find ${foundGold} gold pieces!`, 'info');
            
            // Update gold display
            document.querySelector('.status-line div:nth-child(3)').textContent = `XP: ${gameState.player.xp}/${gameState.player.xpNeeded} | Gold: ${gameState.player.gold}`;
            
            // Chance of triggering combat
            if (Math.random() < 0.2) {
                addLogEntry('Your search has attracted unwanted attention!', 'combat');
                setTimeout(startCombat, 1000);
            }
        }
        
        function rest() {
            if (gameState.inCombat) {
                addLogEntry('You cannot rest while in combat!', 'info');
                return;
            }
            
            const healAmount = Math.floor(gameState.player.maxHp * 0.3);
            gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + healAmount);
            addLogEntry(`You rest and recover ${healAmount} hit points.`, 'heal');
            
            // Update HP display
            document.querySelector('.status-line div:nth-child(2)').textContent = `Level: ${gameState.player.level} | HP: ${gameState.player.hp}/${gameState.player.maxHp}`;
            
            // Chance of random encounter while resting
            if (Math.random() < 0.4) {
                addLogEntry('While resting, you are ambushed!', 'combat');
                setTimeout(startCombat, 1000);
            }
        }
        
        function showMap() {
            addLogEntry('Map of Phlan:', 'info');
            addLogEntry('NORTH: Pool of Radiance', 'info');
            addLogEntry('SOUTH: Outside City Gates', 'info');
            addLogEntry('EAST: Temple District', 'info');
            addLogEntry('WEST: Residential Quarter', 'info');
            addLogEntry('CENTER: Market Square', 'info');
        }
        
        function saveGame() {
            addLogEntry('Game saved. (Note: This is a demo - saving is not functional)', 'info');
        }
        
        function loadGame() {
            addLogEntry('Loaded saved game. (Note: This is a demo - loading is not functional)', 'info');
            showGameScreen();
        }
        
        function toggleCharSheet() {
            const charSheet = document.getElementById('char-sheet');
            charSheet.style.display = charSheet.style.display === 'block' ? 'none' : 'block';
            
            // Hide inventory if showing
            document.getElementById('inventory').style.display = 'none';
        }
        
        function toggleInventory() {
            const inventory = document.getElementById('inventory');
            inventory.style.display = inventory.style.display === 'block' ? 'none' : 'block';
            
            // Hide character sheet if showing
            document.getElementById('char-sheet').style.display = 'none';
        }
        
        // Combat functions
        function startCombat() {
            if (gameState.inCombat) return;
            
            gameState.inCombat = true;
            
            // Reset enemy
            gameState.combatEnemy.hp = gameState.combatEnemy.maxHp;
            
            // Show combat screen
            document.getElementById('combat-screen').classList.add('active-screen');
            
            // Update combat display
            updateCombatDisplay();
            
            // Add to combat log
            addCombatLog(`A ${gameState.combatEnemy.name} attacks!`, 'combat');
            addLogEntry(`You are attacked by a ${gameState.combatEnemy.name}!`, 'combat');
        }
        
        function endCombat(victory) {
            gameState.inCombat = false;
            document.getElementById('combat-screen').classList.remove('active-screen');
            
            if (victory) {
                const xpGained = 25;
                gameState.player.xp += xpGained;
                
                // Check for level up
                if (gameState.player.xp >= gameState.player.xpNeeded) {
                    levelUp();
                }
                
                addLogEntry(`You defeated the ${gameState.combatEnemy.name} and gained ${xpGained} XP!`, 'info');
                
                // Update XP display
                document.querySelector('.status-line div:nth-child(3)').textContent = `XP: ${gameState.player.xp}/${gameState.player.xpNeeded} | Gold: ${gameState.player.gold}`;
            } else {
                addLogEntry('You fled from combat.', 'info');
            }
        }
        
        function updateCombatDisplay() {
            document.getElementById('player-hp').textContent = gameState.player.hp;
            document.getElementById('enemy-hp').textContent = gameState.combatEnemy.hp;
            
            const playerHealthPercent = (gameState.player.hp / gameState.player.maxHp) * 100;
            const enemyHealthPercent = (gameState.combatEnemy.hp / gameState.combatEnemy.maxHp) * 100;
            
            document.getElementById('player-health-bar').style.width = `${playerHealthPercent}%`;
            document.getElementById('enemy-health-bar').style.width = `${enemyHealthPercent}%`;
        }
        
        function attackEnemy() {
            if (!gameState.inCombat) return;
            
            // Player attacks enemy
            const playerDamage = Math.floor(Math.random() * 6) + 1 + 2; // 1d6 + 2 (STR bonus)
            gameState.combatEnemy.hp -= playerDamage;
            
            addCombatLog(`You hit the ${gameState.combatEnemy.name} for ${playerDamage} damage!`, 'damage');
            
            // Check if enemy is defeated
            if (gameState.combatEnemy.hp <= 0) {
                gameState.combatEnemy.hp = 0;
                addCombatLog(`You defeated the ${gameState.combatEnemy.name}!`, 'info');
                updateCombatDisplay();
                setTimeout(() => endCombat(true), 1000);
                return;
            }
            
            // Enemy attacks player
            const enemyDamage = Math.floor(Math.random() * 6) + 1; // 1d6
            gameState.player.hp -= enemyDamage;
            
            addCombatLog(`The ${gameState.combatEnemy.name} hits you for ${enemyDamage} damage!`, 'damage');
            
            // Check if player is defeated
            if (gameState.player.hp <= 0) {
                gameState.player.hp = 0;
                addCombatLog(`You have been defeated!`, 'combat');
                updateCombatDisplay();
                setTimeout(() => {
                    addLogEntry('You have been defeated. Game over!', 'combat');
                    gameState.player.hp = 1; // Reset to 1 HP for demo purposes
                    endCombat(false);
                }, 1500);
                return;
            }
            
            updateCombatDisplay();
        }
        
        function castSpell() {
            if (!gameState.inCombat) return;
            
            if (gameState.player.class === 'Magic-User' || gameState.player.class === 'Cleric') {
                addCombatLog(`You cast a spell at the ${gameState.combatEnemy.name}!`, 'info');
                
                // Spell damage
                const spellDamage = Math.floor(Math.random() * 8) + 1; // 1d8
                gameState.combatEnemy.hp -= spellDamage;
                
                addCombatLog(`Your spell hits for ${spellDamage} damage!`, 'damage');
                
                // Enemy still gets an attack
                setTimeout(() => {
                    if (gameState.combatEnemy.hp > 0) {
                        const enemyDamage = Math.floor(Math.random() * 6) + 1;
                        gameState.player.hp -= enemyDamage;
                        addCombatLog(`The ${gameState.combatEnemy.name} hits you for ${enemyDamage} damage!`, 'damage');
                        updateCombatDisplay();
                    }
                }, 500);
                
                updateCombatDisplay();
                
                // Check if enemy is defeated
                if (gameState.combatEnemy.hp <= 0) {
                    gameState.combatEnemy.hp = 0;
                    addCombatLog(`You defeated the ${gameState.combatEnemy.name}!`, 'info');
                    setTimeout(() => endCombat(true), 1000);
                }
            } else {
                addCombatLog(`Your class cannot cast spells!`, 'info');
            }
        }
        
        function useItem() {
            if (!gameState.inCombat) return;
            
            // Use healing potion
            const healAmount = Math.floor(Math.random() * 8) + 1; // 1d8
            gameState.player.hp = Math.min(gameState.player.maxHp, gameState.player.hp + healAmount);
            
            addCombatLog(`You use a healing potion and recover ${healAmount} hit points!`, 'heal');
            updateCombatDisplay();
            
            // Enemy still gets an attack
            setTimeout(() => {
                const enemyDamage = Math.floor(Math.random() * 6) + 1;
                gameState.player.hp -= enemyDamage;
                addCombatLog(`The ${gameState.combatEnemy.name} hits you for ${enemyDamage} damage!`, 'damage');
                updateCombatDisplay();
            }, 500);
        }
        
        function fleeCombat() {
            if (!gameState.inCombat) return;
            
            const fleeChance = 0.6; // 60% chance to flee successfully
            
            if (Math.random() < fleeChance) {
                addCombatLog('You successfully flee from combat!', 'info');
                setTimeout(() => endCombat(false), 500);
            } else {
                addCombatLog('You failed to flee!', 'combat');
                
                // Enemy gets a free attack
                const enemyDamage = Math.floor(Math.random() * 6) + 1;
                gameState.player.hp -= enemyDamage;
                addCombatLog(`The ${gameState.combatEnemy.name} hits you for ${enemyDamage} damage as you try to flee!`, 'damage');
                updateCombatDisplay();
            }
        }
        
        function levelUp() {
            gameState.player.level++;
            gameState.player.maxHp += Math.floor(Math.random() * 6) + 1 + 1; // 1d6 + CON bonus
            gameState.player.hp = gameState.player.maxHp;
            gameState.player.xpNeeded = gameState.player.level * 1000;
            
            addLogEntry(`Congratulations! You reached level ${gameState.player.level}!`, 'info');
            addLogEntry(`Your maximum HP is now ${gameState.player.maxHp}.`, 'heal');
            
            // Update displays
            document.querySelector('.status-line div:nth-child(2)').textContent = `Level: ${gameState.player.level} | HP: ${gameState.player.hp}/${gameState.player.maxHp}`;
            document.querySelector('.status-line div:nth-child(3)').textContent = `XP: ${gameState.player.xp}/${gameState.player.xpNeeded} | Gold: ${gameState.player.gold}`;
        }
        
        // Logging functions
        function addLogEntry(message, type = 'info') {
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `> ${message}`;
            
            eventLog.appendChild(logEntry);
            eventLog.scrollTop = eventLog.scrollHeight;
        }
        
        function addCombatLog(message, type = 'info') {
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `> ${message}`;
            
            combatLog.appendChild(logEntry);
            combatLog.scrollTop = combatLog.scrollHeight;
        }
        
        // Command input handler
        function handleCommandInput(event) {
            if (event.key === 'Enter') {
                const command = commandInput.value.trim().toLowerCase();
                commandInput.value = '';
                
                if (!command) return;
                
                addLogEntry(command, 'info');
                
                // Parse and execute command
                executeCommand(command);
            }
        }
        
        function executeCommand(command) {
            const parts = command.split(' ');
            const verb = parts[0];
            const target = parts.slice(1).join(' ');
            
            switch(verb) {
                case 'north':
                case 'n':
                    move('north');
                    break;
                case 'south':
                case 's':
                    move('south');
                    break;
                case 'east':
                case 'e':
                    move('east');
                    break;
                case 'west':
                case 'w':
                    move('west');
                    break;
                case 'go':
                    if (target) {
                        move(target);
                    } else {
                        addLogEntry('Go where? Specify a direction.', 'info');
                    }
                    break;
                case 'attack':
                    if (gameState.inCombat) {
                        attackEnemy();
                    } else {
                        addLogEntry('There is nothing to attack here.', 'info');
                    }
                    break;
                case 'search':
                    searchArea();
                    break;
                case 'rest':
                    rest();
                    break;
                case 'map':
                    showMap();
                    break;
                case 'save':
                    saveGame();
                    break;
                case 'load':
                    loadGame();
                    break;
                case 'character':
                case 'char':
                    toggleCharSheet();
                    break;
                case 'inventory':
                case 'inv':
                    toggleInventory();
                    break;
                case 'help':
                    showHelp();
                    break;
                case 'look':
                    updateLocationDisplay();
                    addLogEntry(`You look around ${gameState.currentLocation}.`, 'info');
                    break;
                default:
                    addLogEntry(`Unknown command: "${command}". Type HELP for available commands.`, 'info');
            }
        }
        
        function showHelp() {
            addLogEntry('Available commands:', 'info');
            addLogEntry('NORTH, SOUTH, EAST, WEST or N, S, E, W - Move in that direction', 'info');
            addLogEntry('GO [direction] - Move in specified direction', 'info');
            addLogEntry('ATTACK - Attack enemy in combat', 'info');
            addLogEntry('SEARCH - Search current area', 'info');
            addLogEntry('REST - Rest to recover HP', 'info');
            addLogEntry('MAP - Show map of Phlan', 'info');
            addLogEntry('SAVE - Save game progress', 'info');
            addLogEntry('CHARACTER or CHAR - Show character sheet', 'info');
            addLogEntry('INVENTORY or INV - Show inventory', 'info');
            addLogEntry('LOOK - Look at current location', 'info');
            addLogEntry('HELP - Show this help message', 'info');
        }
        
        // Initialize the game when the page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>

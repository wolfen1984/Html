<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dracula's Last Rise - Level 3: Mountains of Moor</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Retro DOS computer style - Blood Red/Black theme */
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Source Code Pro', 'Courier New', monospace;
            background-color: #000;
            color: #fff;
            margin: 0;
            padding: 10px;
            line-height: 1.5;
            max-width: 100%;
            overflow-x: hidden;
            min-height: 100vh;
            background-image: 
                linear-gradient(rgba(120, 0, 0, 0.15) 1px, transparent 1px),
                linear-gradient(90deg, rgba(120, 0, 0, 0.15) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        .container {
            max-width: 700px;
            margin: 0 auto;
            padding: 15px;
            border: 3px solid #cc0000;
            background-color: #000;
            box-shadow: 0 0 30px rgba(204, 0, 0, 0.5);
            position: relative;
            min-height: calc(100vh - 40px);
            overflow: hidden;
        }
        
        /* Scanline effect for authentic CRT monitor feel */
        .container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 50%,
                rgba(120, 0, 0, 0.1) 50%
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 2;
        }
        
        .header {
            text-align: center;
            border-bottom: 2px dashed #cc0000;
            padding-bottom: 15px;
            margin-bottom: 20px;
            position: relative;
        }
        
        h1 {
            font-family: 'Press Start 2P', 'Courier New', monospace;
            color: #cc0000;
            text-shadow: 0 0 8px #cc0000;
            font-size: 32px;
            margin: 10px 0;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-weight: normal;
        }
        
        h2 {
            font-family: 'Press Start 2P', 'Courier New', monospace;
            color: #fff;
            border-bottom: 1px solid #cc0000;
            padding-bottom: 5px;
            margin-top: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 20px;
            font-weight: normal;
        }
        
        .screen {
            display: none;
            position: relative;
            z-index: 1;
        }
        
        .active-screen {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Level Progress Indicator */
        .level-progress {
            display: flex;
            justify-content: space-between;
            background-color: #111;
            border: 1px solid #cc0000;
            padding: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .level-number {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #333;
            font-weight: bold;
            color: #888;
            background-color: #222;
            font-family: 'Press Start 2P', 'Courier New', monospace;
            font-size: 12px;
        }
        
        .level-number.completed {
            background-color: #220000;
            color: #cc8888;
            border-color: #cc8888;
        }
        
        .level-number.current {
            background-color: #cc0000;
            color: #000;
            border-color: #cc0000;
            box-shadow: 0 0 12px #cc0000;
            text-shadow: 0 0 2px #000;
            font-weight: bold;
        }
        
        /* Stats Bar */
        .stats-bar {
            background-color: #111;
            border: 1px solid #cc0000;
            padding: 10px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            font-size: 14px;
        }
        
        .stat-item {
            margin: 5px 10px;
        }
        
        .stat-label {
            color: #fff;
        }
        
        .stat-value {
            color: #cc0000;
            font-weight: bold;
            font-size: 16px;
        }
        
        /* Inventory */
        .inventory-container {
            background-color: #111;
            border: 1px solid #cc0000;
            padding: 10px;
            margin: 15px 0;
        }
        
        .inventory-title {
            color: #cc0000;
            margin-bottom: 10px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Press Start 2P', 'Courier New', monospace;
            font-size: 14px;
        }
        
        .inventory {
            min-height: 60px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .inventory-item {
            display: inline-block;
            background-color: #222;
            border: 1px solid #cc0000;
            padding: 8px 12px;
            color: #fff;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .inventory-item:hover {
            background-color: #333;
            border-color: #ff4444;
            transform: translateY(-2px);
        }
        
        .inventory-item.equipped::after {
            content: "E";
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #cc0000;
            color: #000;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-family: 'Press Start 2P', 'Courier New', monospace;
        }
        
        /* Story Text Area */
        .story-text {
            background-color: #000;
            border: 1px solid #cc0000;
            padding: 15px;
            margin: 20px 0;
            min-height: 200px;
            overflow-y: auto;
            max-height: 350px;
            font-size: 16px;
            line-height: 1.6;
            color: #fff;
        }
        
        /* Choice Buttons */
        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }
        
        .choice-btn {
            background-color: #222;
            color: #fff;
            border: 2px solid #cc0000;
            padding: 15px;
            font-family: 'Source Code Pro', 'Courier New', monospace;
            font-size: 16px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        .choice-btn:hover, .choice-btn:active {
            background-color: #333;
            color: #ff4444;
            border-color: #ff4444;
            box-shadow: 0 0 10px rgba(255, 68, 68, 0.3);
        }
        
        .choice-btn::after {
            content: ">";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #cc0000;
            font-weight: bold;
        }
        
        .choice-btn:hover::after {
            color: #ff4444;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-top: 20px;
            gap: 10px;
        }
        
        .action-btn {
            background-color: #222;
            color: #fff;
            border: 2px solid #cc0000;
            padding: 10px 15px;
            font-family: 'Source Code Pro', 'Courier New', monospace;
            font-size: 14px;
            cursor: pointer;
            flex-grow: 1;
            text-align: center;
            transition: all 0.2s;
        }
        
        .action-btn:hover, .action-btn:active {
            background-color: #333;
            color: #ff4444;
            border-color: #ff4444;
        }
        
        /* Dice Roll Display */
        .dice-roll {
            background-color: #330000;
            border: 1px solid #cc0000;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            color: #cc0000;
            font-weight: bold;
        }
        
        /* Combat Display */
        .combat-log {
            background-color: #550000;
            border: 1px solid #ff0000;
            padding: 10px;
            margin: 10px 0;
            color: #cc0000;
            font-weight: bold;
        }
        
        /* Special Text Styles */
        .game-over {
            color: #f66;
            font-weight: bold;
            text-align: center;
            font-size: 24px;
            margin: 20px;
            text-shadow: 0 0 5px #f66;
            font-family: 'Press Start 2P', 'Courier New', monospace;
        }
        
        .victory {
            color: #cc0000;
            font-weight: bold;
            text-align: center;
            font-size: 24px;
            margin: 20px;
            text-shadow: 0 0 8px #cc0000;
            font-family: 'Press Start 2P', 'Courier New', monospace;
        }
        
        .success {
            color: #6f6;
            font-weight: bold;
        }
        
        .damage {
            color: #f66;
            font-weight: bold;
        }
        
        .enemy {
            color: #fa6;
            font-weight: bold;
        }
        
        .gold {
            color: #ffd700;
            font-weight: bold;
        }
        
        .item {
            color: #8ff;
            font-weight: bold;
        }
        
        .vampire {
            color: #f66;
            font-weight: bold;
            text-shadow: 0 0 3px #f66;
        }
        
        .npc {
            color: #6f9;
            font-weight: bold;
        }
        
        .mountains {
            color: #aac;
            font-weight: bold;
            text-shadow: 0 0 2px #aac;
        }
        
        .church {
            color: #ccc;
            font-weight: bold;
        }
        
        .vampire-spawn {
            color: #f48;
            font-weight: bold;
        }
        
        .dark-priest {
            color: #f66;
            text-shadow: 0 0 3px #f66;
            font-weight: bold;
        }
        
        .ice-wraith {
            color: #8cf;
            font-weight: bold;
        }
        
        .mountain-pass {
            color: #ccc;
            font-weight: bold;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            color: #888;
            font-size: 12px;
            margin-top: 20px;
            border-top: 1px solid #333;
            padding-top: 10px;
            font-family: 'Source Code Pro', 'Courier New', monospace;
        }
        
        /* Blinking cursor effect */
        .blinking-cursor {
            display: inline-block;
            width: 10px;
            height: 20px;
            background-color: #cc0000;
            vertical-align: middle;
            margin-left: 5px;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Sound Toggle */
        .sound-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #111;
            border: 1px solid #cc0000;
            color: #fff;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
            z-index: 10;
            font-family: 'Source Code Pro', 'Courier New', monospace;
        }
        
        .sound-toggle:hover {
            background: #222;
            color: #ff4444;
        }
        
        /* New Game Button */
        .new-game-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #111;
            border: 1px solid #cc0000;
            color: #fff;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
            z-index: 10;
            font-family: 'Source Code Pro', 'Courier New', monospace;
        }
        
        .new-game-btn:hover {
            background: #222;
            color: #ff4444;
        }
        
        /* Responsive Design */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            h2 {
                font-size: 16px;
            }
            
            .stats-bar {
                font-size: 12px;
            }
            
            .choice-btn {
                padding: 12px;
                font-size: 14px;
            }
            
            .level-number {
                width: 25px;
                height: 25px;
                font-size: 10px;
            }
            
            .inventory-title {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sound Toggle -->
        <div class="sound-toggle" onclick="toggleSound()">
            SOUND: <span id="sound-status">ON</span>
        </div>
        
        <!-- New Game Button -->
        <div class="new-game-btn" onclick="newGame()">
            NEW GAME
        </div>
        
        <div class="header">
            <h1>DRACULA'S LAST RISE</h1>
            <h2>LEVEL 3: MOUNTAINS OF MOOR</h2>
        </div>
        
        <!-- Level Progress Indicator -->
        <div class="level-progress">
            <div class="level-number completed">1</div>
            <div class="level-number completed">2</div>
            <div class="level-number current">3</div>
            <div class="level-number">4</div>
            <div class="level-number">5</div>
            <div class="level-number">6</div>
            <div class="level-number">7</div>
            <div class="level-number">8</div>
            <div class="level-number">9</div>
            <div class="level-number">10</div>
        </div>
        
        <!-- Game Screen -->
        <div id="screen-game" class="screen active-screen">
            <div class="stats-bar">
                <div class="stat-item"><span class="stat-label">STRENGTH:</span> <span id="stat-strength" class="stat-value">0</span></div>
                <div class="stat-item"><span class="stat-label">HEALTH:</span> <span id="stat-health" class="stat-value">0</span>/<span id="stat-maxhealth" class="stat-value">0</span></div>
                <div class="stat-item"><span class="stat-label">AGILITY:</span> <span id="stat-agility" class="stat-value">0</span></div>
                <div class="stat-item"><span class="stat-label">GOLD:</span> <span id="stat-gold" class="stat-value">0</span></div>
            </div>
            
            <div class="inventory-container">
                <div class="inventory-title">
                    <span>INVENTORY</span>
                    <span id="inventory-count">ITEMS: 0/10</span>
                </div>
                <div class="inventory" id="inventory">
                    <!-- Inventory items will be added here -->
                </div>
            </div>
            
            <h2>MOUNTAINS OF MOOR</h2>
            <div class="story-text" id="story-text">
                <!-- Story content will be inserted here -->
            </div>
            
            <div class="choice-buttons" id="choice-buttons">
                <!-- Choice buttons will be inserted here -->
            </div>
            
            <div class="action-buttons">
                <button class="action-btn" onclick="useAgility()">USE AGILITY</button>
                <button class="action-btn" onclick="useItem()">USE ITEM</button>
                <button class="action-btn" onclick="saveGame()">SAVE GAME</button>
                <button class="action-btn" onclick="loadGame()">LOAD GAME</button>
            </div>
        </div>
        
        <!-- Level Complete Screen -->
        <div id="screen-complete" class="screen">
            <h2>MOUNTAINS CONQUERED!</h2>
            <div class="story-text">
                <p class="victory">YOU HAVE COMPLETED LEVEL 3!</p>
                <div style="margin-top: 15px; padding: 10px; background-color: #330000; border: 1px solid #cc0000;">
                    <p>You stand at the highest peak of the <span class="mountains">Mountains of Moor</span>, looking down at the valley below. The <span class="church">old church</span> now lies in ruins behind you, its dark power shattered by your hand.</p>
                    <p>From the notes and maps you found in the church, you now know the location of Dracula's main fortress. It lies in the valley beyond the mountains, protected by ancient magic and guarded by his most loyal servants.</p>
                    <p>As you descend the mountain path, you see it in the distance: <span class="vampire">Castle Dracula</span>, a dark silhouette against the stormy sky. The final battle approaches.</p>
                </div>
                
                <div class="stats-bar">
                    <div class="stat-item"><span class="stat-label">FINAL STRENGTH:</span> <span id="complete-stat-strength" class="stat-value">0</span></div>
                    <div class="stat-item"><span class="stat-label">FINAL HEALTH:</span> <span id="complete-stat-health" class="stat-value">0</span></div>
                    <div class="stat-item"><span class="stat-label">FINAL AGILITY:</span> <span id="complete-stat-agility" class="stat-value">0</span></div>
                    <div class="stat-item"><span class="stat-label">FINAL GOLD:</span> <span id="complete-stat-gold" class="stat-value">0</span></div>
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background-color: #003322; border: 1px solid #00ff88;">
                    <h3 style="color: #00ff88; margin-top: 0;">YOUR PROGRESS:</h3>
                    <p>You've survived the treacherous mountains and destroyed the cult's stronghold. The Dark Priest is defeated, and the ritual to resurrect Dracula has been disrupted.</p>
                    <p>But Dracula himself still lives, gathering his strength in his castle below. The <span class="vampire">Castle Gates</span> await - the final barrier between you and the vampire lord.</p>
                    <p>You've learned that Dracula is vulnerable during the day, and that he keeps ancient artifacts in his castle that could be his undoing. Time is running out.</p>
                </div>
            </div>
            
            <div class="choice-buttons">
                <button class="choice-btn" onclick="goToNextLevel()">CONTINUE TO LEVEL 4: OUTSIDE THE CASTLE GATES</button>
            </div>
        </div>
        
        <div class="footer">
            DRACULA'S LAST RISE - A Gothic Horror Adventure<br>
            Level 3: Mountains of Moor
        </div>
    </div>

    <script>
        // Sound System
        let soundEnabled = true;
        let audioContext;
        
        // Simple beep generator using Web Audio API
        function playBeep(frequency, duration, type = 'square') {
            if (!soundEnabled) return;
            
            try {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = type;
                
                // Volume envelope
                gainNode.gain.setValueAtTime(0, audioContext.currentTime);
                gainNode.gain.linearRampToValueAtTime(0.1, audioContext.currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            } catch (e) {
                console.log("Web Audio not supported:", e);
            }
        }
        
        // Sound effects for level 3
        function playSound(type) {
            if (!soundEnabled) return;
            
            switch(type) {
                case 'click':
                    playBeep(800, 0.1, 'square');
                    break;
                case 'roll':
                    playBeep(400, 0.05, 'sine');
                    setTimeout(() => playBeep(600, 0.05, 'sine'), 50);
                    setTimeout(() => playBeep(300, 0.1, 'sine'), 100);
                    break;
                case 'combat':
                    playBeep(1200, 0.05, 'sawtooth');
                    break;
                case 'item':
                    playBeep(600, 0.2, 'triangle');
                    break;
                case 'success':
                    playBeep(1000, 0.15, 'sine');
                    setTimeout(() => playBeep(1200, 0.15, 'sine'), 150);
                    break;
                case 'failure':
                    playBeep(300, 0.3, 'sawtooth');
                    break;
                case 'damage':
                    playBeep(200, 0.2, 'square');
                    break;
                case 'victory':
                    playBeep(500, 0.1, 'sine');
                    setTimeout(() => playBeep(700, 0.1, 'sine'), 100);
                    setTimeout(() => playBeep(900, 0.1, 'sine'), 200);
                    setTimeout(() => playBeep(1100, 0.2, 'sine'), 300);
                    setTimeout(() => playBeep(1300, 0.3, 'sine'), 500);
                    break;
                case 'gold':
                    playBeep(1000, 0.1, 'sine');
                    for(let i = 0; i < 5; i++) {
                        setTimeout(() => playBeep(800 + i*100, 0.1, 'sine'), 100 + i*100);
                    }
                    break;
                case 'vampire':
                    playBeep(200, 0.4, 'square');
                    setTimeout(() => playBeep(150, 0.4, 'square'), 400);
                    setTimeout(() => playBeep(100, 0.4, 'square'), 800);
                    break;
                case 'mountains':
                    playBeep(400, 0.3, 'sine');
                    setTimeout(() => playBeep(300, 0.3, 'sine'), 300);
                    setTimeout(() => playBeep(200, 0.3, 'sine'), 600);
                    break;
                case 'wind':
                    for(let i = 0; i < 3; i++) {
                        setTimeout(() => playBeep(500 + i*50, 0.5, 'sine'), i*500);
                    }
                    break;
                case 'ice':
                    playBeep(800, 0.1, 'triangle');
                    setTimeout(() => playBeep(600, 0.2, 'triangle'), 100);
                    break;
                case 'priest':
                    playBeep(400, 0.3, 'sawtooth');
                    setTimeout(() => playBeep(350, 0.3, 'sawtooth'), 300);
                    break;
                case 'church':
                    playBeep(300, 0.5, 'sine');
                    break;
            }
        }
        
        // Toggle sound on/off
        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('sound-status').textContent = soundEnabled ? 'ON' : 'OFF';
            
            if (soundEnabled) {
                playSound('click');
            }
        }
        
        // New Game function
        function newGame() {
            playSound('click');
            if (confirm("Start a new game? This will erase your current progress.")) {
                localStorage.removeItem('draculaGameState');
                window.location.href = 'le1.html';
            }
        }
        
        // Game state object - loaded from localStorage
        const savedState = JSON.parse(localStorage.getItem('draculaGameState'));
        let gameState;
        
        // If no saved game or wrong level, create default state for Level 3
        if (!savedState || savedState.level !== 3) {
            // Create a default state for Level 3 if player comes directly without completing previous levels
            gameState = {
                playerClass: 'warrior',
                strength: 20,
                maxHealth: 70,
                health: 70,
                agility: 14,
                gold: 80,
                inventory: ['Health Potion', 'Silver Amulet', 'Torch', 'Healing Herbs'],
                equippedWeapon: 'Steel Sword',
                equippedArmor: 'Leather Armor',
                currentSection: 1,
                gameComplete: false,
                level: 3,
                // Level completion flags
                level1Complete: true,
                level2Complete: true,
                level3Complete: false
            };
        } else {
            // Use the saved state
            gameState = savedState;
            
            // Ensure level is set to 3
            gameState.level = 3;
            gameState.level3Complete = false;
            gameState.gameComplete = false;
            
            // Mark previous levels as completed
            gameState.level1Complete = true;
            gameState.level2Complete = true;
        }
        
        // Combat state
        let combatState = {
            active: false,
            enemyName: '',
            enemyHealth: 0,
            enemyCurrentHealth: 0,
            enemyStrength: 0,
            nextSection: 0
        };
        
        // Initialize game
        function initGame() {
            // Check if Level 3 is already completed
            if (gameState.level3Complete) {
                showCompleteScreen();
                return;
            }
            
            // Update display and start the game
            updateStatsDisplay();
            updateInventoryDisplay();
            loadSection(gameState.currentSection);
        }
        
        // Update stats display
        function updateStatsDisplay() {
            document.getElementById('stat-strength').textContent = gameState.strength;
            document.getElementById('stat-health').textContent = gameState.health;
            document.getElementById('stat-maxhealth').textContent = gameState.maxHealth;
            document.getElementById('stat-agility').textContent = gameState.agility;
            document.getElementById('stat-gold').textContent = gameState.gold;
        }
        
        // Add item to inventory
        function addToInventory(item) {
            if (!gameState.inventory.includes(item) && item !== gameState.equippedWeapon && item !== gameState.equippedArmor) {
                gameState.inventory.push(item);
                updateInventoryDisplay();
            }
        }
        
        // Remove item from inventory
        function removeFromInventory(item) {
            const index = gameState.inventory.indexOf(item);
            if (index !== -1) {
                gameState.inventory.splice(index, 1);
                updateInventoryDisplay();
            }
        }
        
        // Update inventory display
        function updateInventoryDisplay() {
            const inventoryDiv = document.getElementById('inventory');
            inventoryDiv.innerHTML = '';
            
            // Add equipped weapon and armor first
            const equippedWeapon = document.createElement('div');
            equippedWeapon.className = 'inventory-item equipped';
            equippedWeapon.textContent = gameState.equippedWeapon;
            equippedWeapon.onclick = () => {
                playSound('click');
                document.getElementById('story-text').innerHTML += 
                    `<div class="dice-roll">Currently equipped: <span class='item'>${gameState.equippedWeapon}</span></div>`;
            };
            inventoryDiv.appendChild(equippedWeapon);
            
            const equippedArmor = document.createElement('div');
            equippedArmor.className = 'inventory-item equipped';
            equippedArmor.textContent = gameState.equippedArmor;
            equippedArmor.onclick = () => {
                playSound('click');
                document.getElementById('story-text').innerHTML += 
                    `<div class="dice-roll">Currently equipped: <span class='item'>${gameState.equippedArmor}</span></div>`;
            };
            inventoryDiv.appendChild(equippedArmor);
            
            // Add other inventory items
            gameState.inventory.forEach(item => {
                // Skip if it's the equipped weapon or armor
                if (item !== gameState.equippedWeapon && item !== gameState.equippedArmor) {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'inventory-item';
                    itemElement.textContent = item;
                    itemElement.onclick = () => {
                        useInventoryItem(item);
                    };
                    inventoryDiv.appendChild(itemElement);
                }
            });
            
            // Update inventory count
            const totalItems = gameState.inventory.length + 2; // +2 for equipped items
            document.getElementById('inventory-count').textContent = `ITEMS: ${totalItems}/10`;
        }
        
        // Use inventory item
        function useInventoryItem(item) {
            playSound('click');
            let message = "";
            
            if (item === 'Health Potion') {
                const healAmount = rollDice(2, 6) + 5;
                const oldHealth = gameState.health;
                gameState.health = Math.min(gameState.maxHealth, gameState.health + healAmount);
                const actualHeal = gameState.health - oldHealth;
                removeFromInventory(item);
                playSound('item');
                message = `You drink the <span class='item'>Health Potion</span> and restore ${actualHeal} Health!`;
                updateStatsDisplay();
            } else if (item === 'Healing Herbs') {
                const healAmount = rollDice(1, 6) + 2;
                const oldHealth = gameState.health;
                gameState.health = Math.min(gameState.maxHealth, gameState.health + healAmount);
                const actualHeal = gameState.health - oldHealth;
                removeFromInventory(item);
                playSound('item');
                message = `You use the <span class='item'>Healing Herbs</span> and restore ${actualHeal} Health!`;
                updateStatsDisplay();
            } else if (item === 'Silver Amulet') {
                message = "The <span class='item'>Silver Amulet</span> feels warm to the touch. It offers protection against dark creatures.";
            } else if (item === 'Torch') {
                message = "The <span class='item'>Torch</span> illuminates dark places and provides warmth in the cold mountains.";
            } else {
                message = `You examine the <span class='item'>${item}</span>.`;
            }
            
            document.getElementById('story-text').innerHTML += `<div class="dice-roll">${message}</div>`;
        }
        
        // Use item from action button
        function useItem() {
            playSound('click');
            if (gameState.inventory.length === 0) {
                document.getElementById('story-text').innerHTML += 
                    `<div class="dice-roll">You have no usable items in your inventory.</div>`;
                return;
            }
            
            let itemText = "<div class='dice-roll'><strong>Select an item to use:</strong><br>";
            
            // Show equipped items
            itemText += `<br><strong>Equipped:</strong><br>`;
            itemText += `<button onclick="useInventoryItem('${gameState.equippedWeapon}')" class="action-btn" style="margin: 5px;">${gameState.equippedWeapon}</button> `;
            itemText += `<button onclick="useInventoryItem('${gameState.equippedArmor}')" class="action-btn" style="margin: 5px;">${gameState.equippedArmor}</button>`;
            
            // Show inventory items
            const usableItems = gameState.inventory.filter(item => 
                item !== gameState.equippedWeapon && item !== gameState.equippedArmor);
            
            if (usableItems.length > 0) {
                itemText += `<br><br><strong>Inventory:</strong><br>`;
                usableItems.forEach(item => {
                    itemText += `<button onclick="useInventoryItem('${item}')" class="action-btn" style="margin: 5px;">${item}</button> `;
                });
            }
            
            itemText += `<br><br><button onclick="document.getElementById('story-text').innerHTML += '<div class=dice-roll>Item use cancelled.</div>'" class="action-btn">Cancel</button>`;
            itemText += "</div>";
            
            document.getElementById('story-text').innerHTML += itemText;
        }
        
        // Game story sections for Level 3 (Simplified)
        const storySections = {
            1: {
                text: "You stand at the base of the <span class='mountains'>Mountains of Moor</span>, looking up at the towering peaks. The old church from the woodlands is now behind you. Before you lies the treacherous mountain path that leads to Dracula's castle. The air is thin and cold, and a howling wind whips through the rocky passes.",
                choices: [
                    {text: "Take the main mountain path", nextSection: 2, skillCheck: false},
                    {text: "Scale the cliffs for a shortcut", nextSection: 3, skillCheck: true, checkType: 'agility', difficulty: 16},
                    {text: "Follow a narrow goat trail along the ridge", nextSection: 4, skillCheck: false}
                ]
            },
            2: {
                text: "The main path is steep but well-traveled. You notice recent footprints in the snow - too large to be human. Strange symbols are carved into the rocks along the path, glowing faintly with dark energy.",
                choices: [
                    {text: "Continue up the path cautiously", nextSection: 5, skillCheck: false},
                    {text: "Investigate the glowing symbols", nextSection: 6, skillCheck: false},
                    {text: "Hide and watch for movement ahead", nextSection: 7, skillCheck: true, checkType: 'agility', difficulty: 15}
                ]
            },
            3: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 8, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You skillfully scale the cliffs, finding handholds where none seemed to exist. You reach a high vantage point that gives you a clear view of the mountain pass ahead.";
                    } else {
                        const damage = rollDice(2, 6);
                        gameState.health -= damage;
                        updateStatsDisplay();
                        playSound('damage');
                        return "You slip and fall, taking " + damage + " damage! You land back on the main path, bruised but alive.";
                    }
                }
            },
            4: {
                text: "The goat trail is narrow and treacherous, winding along a steep ridge. One wrong step would mean a fatal fall. The wind howls louder here, carrying strange whispers on the air.",
                choices: [
                    {text: "Continue along the ridge", nextSection: 9, skillCheck: true, checkType: 'agility', difficulty: 17},
                    {text: "Turn back and take the main path", nextSection: 2, skillCheck: false}
                ]
            },
            5: {
                text: "As you ascend, the temperature drops dramatically. Snow begins to fall, reducing visibility. Through the swirling snow, you see a dark shape moving ahead - a creature made of ice and shadow.",
                choices: [
                    {text: "Approach the creature cautiously", nextSection: 10, skillCheck: false},
                    {text: "Hide behind rocks and observe", nextSection: 11, skillCheck: true, checkType: 'agility', difficulty: 16},
                    {text: "Prepare your weapon for combat", nextSection: 12, skillCheck: false}
                ]
            },
            6: {
                text: "You examine the glowing symbols. They're ancient runes of binding and summoning. The cult is using them to strengthen Dracula's connection to this place.",
                choices: [
                    {text: "Deface the symbol to disrupt the magic", nextSection: 13, skillCheck: true, checkType: 'strength', difficulty: 15},
                    {text: "Continue up the path", nextSection: 5, skillCheck: false}
                ]
            },
            7: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 14, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You hide behind a large rock and wait. Soon, a group of three cultists passes by, chanting as they carry supplies up the mountain. They don't notice you.";
                    } else {
                        playSound('failure');
                        return "You try to hide but knock loose a rock. The cultists ahead turn toward the noise!";
                        // Force encounter
                        setTimeout(() => {
                            loadSection(15);
                        }, 1500);
                        return "";
                    }
                }
            },
            8: {
                text: "After scaling the cliffs, you find yourself on a high ledge overlooking the mountain pass. Below, you can see the old church and the path you took through the woodlands.",
                choices: [
                    {text: "Descend to rejoin the main path", nextSection: 5, skillCheck: false}
                ]
            },
            9: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 16, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You navigate the treacherous ridge with expert skill. The goat trail leads you to an ancient stone bridge spanning a deep chasm.";
                    } else {
                        const damage = rollDice(3, 6);
                        gameState.health -= damage;
                        updateStatsDisplay();
                        playSound('damage');
                        return "You slip on the icy path! You tumble down the slope, taking " + damage + " damage before catching yourself on an outcropping.";
                    }
                }
            },
            10: {
                text: "You approach the Ice Wraith. It turns to face you, letting out a piercing shriek that echoes through the mountains. Frost forms on your weapon as it draws near.",
                choices: [
                    {text: "Attack the Ice Wraith", nextSection: 17, skillCheck: false},
                    {text: "Use your torch to scare it", nextSection: 18, skillCheck: false, requirement: function() { return gameState.inventory.includes('Torch'); }}
                ]
            },
            11: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 19, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You remain hidden as the Ice Wraith passes by. It seems to be patrolling this area. Once it's gone, you can continue safely.";
                    } else {
                        playSound('ice');
                        return "The Ice Wraith senses your presence! Its head turns toward your hiding spot.";
                        // Force combat
                        setTimeout(() => {
                            loadSection(17);
                        }, 1500);
                        return "";
                    }
                }
            },
            12: {
                text: "You ready your weapon as the Ice Wraith approaches. The cold emanating from it is intense, making your fingers numb.",
                choices: [
                    {text: "Attack!", nextSection: 17, skillCheck: false}
                ]
            },
            13: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 20, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You scrape away part of the symbol with your weapon. The glow fades immediately, and you feel a subtle shift in the air. You've weakened Dracula's connection to this place.";
                    } else {
                        playSound('failure');
                        const damage = rollDice(1, 6);
                        gameState.health -= damage;
                        updateStatsDisplay();
                        return "As you try to deface the symbol, dark energy lashes out, striking you for " + damage + " damage! The symbol remains intact.";
                    }
                }
            },
            14: {
                text: "After observing the cultists pass, you continue up the path. Their chanting grows fainter as they disappear around a bend ahead.",
                choices: [
                    {text: "Follow the cultists", nextSection: 21, skillCheck: false},
                    {text: "Take a different route to avoid them", nextSection: 22, skillCheck: false}
                ]
            },
            15: {
                text: "The cultists attack! There are three of them, armed with ritual daggers.",
                choices: [
                    {text: "Fight!", nextSection: 23, skillCheck: false}
                ],
                action: function() {
                    combatState.active = true;
                    combatState.enemyName = "Mountain Cultists";
                    combatState.enemyHealth = 40;
                    combatState.enemyCurrentHealth = 40;
                    combatState.enemyStrength = 14;
                    combatState.nextSection = 24;
                    
                    playSound('combat');
                    return "<span class='enemy'>Mountain Cultists</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            16: {
                text: "You reach the ancient stone bridge. It spans a chasm hundreds of feet deep. The bridge looks old and unstable.",
                choices: [
                    {text: "Cross the bridge carefully", nextSection: 25, skillCheck: true, checkType: 'agility', difficulty: 16},
                    {text: "Look for another way across", nextSection: 26, skillCheck: false}
                ]
            },
            17: {
                text: "You attack the Ice Wraith! Its form shimmers and shifts, making it difficult to hit.",
                choices: [
                    {text: "Fight!", nextSection: 27, skillCheck: false}
                ],
                action: function() {
                    combatState.active = true;
                    combatState.enemyName = "Ice Wraith";
                    combatState.enemyHealth = 45;
                    combatState.enemyCurrentHealth = 45;
                    combatState.enemyStrength = 16;
                    combatState.nextSection = 28;
                    
                    playSound('ice');
                    return "<span class='ice-wraith'>Ice Wraith</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            18: {
                text: "You raise your torch. The Ice Wraith recoils from the heat and light!",
                choices: [
                    {text: "Attack while it's afraid of the fire", nextSection: 29, skillCheck: false}
                ],
                action: function() {
                    playSound('success');
                    return "The Ice Wraith hisses and backs away. Fire is its weakness!";
                }
            },
            19: {
                text: "After the Ice Wraith passes, you continue up the mountain path. The snow falls more heavily now, making progress difficult.",
                choices: [
                    {text: "Continue toward the church", nextSection: 30, skillCheck: false}
                ]
            },
            20: {
                text: "After disrupting the dark symbol, you feel a shift in the mountain's energy. The whispers on the wind grow fainter.",
                choices: [
                    {text: "Continue up the path", nextSection: 5, skillCheck: false}
                ]
            },
            21: {
                text: "You follow the cultists at a distance. They lead you to a hidden entrance in the mountainside - a cave that appears to go deep into the mountain.",
                choices: [
                    {text: "Enter the cave", nextSection: 31, skillCheck: false},
                    {text: "Continue to the church above", nextSection: 30, skillCheck: false}
                ]
            },
            22: {
                text: "You take a different route, circling around to approach the church from a different angle. The path is more difficult but likely less guarded.",
                choices: [
                    {text: "Continue on this path", nextSection: 32, skillCheck: true, checkType: 'agility', difficulty: 16}
                ]
            },
            23: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 23, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the cultists!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            24: {
                text: "After dealing with the cultists, you search their bodies. They were carrying supplies to the mountain church.",
                choices: [
                    {text: "Continue up the mountain", nextSection: 30, skillCheck: false}
                ],
                action: function() {
                    const goldFound = rollDice(2, 10);
                    gameState.gold += goldFound;
                    addToInventory('Mountain Supplies');
                    updateStatsDisplay();
                    playSound('gold');
                    return "You find <span class='gold'>" + goldFound + " Gold</span> and <span class='item'>Mountain Supplies</span>.";
                }
            },
            25: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 33, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You cross the ancient bridge carefully, testing each step. Halfway across, you feel the bridge shudder, but it holds. You make it to the other side safely.";
                    } else {
                        const damage = rollDice(3, 8);
                        gameState.health -= damage;
                        updateStatsDisplay();
                        playSound('damage');
                        return "A stone gives way beneath your foot! You fall through the bridge, catching yourself on a support beam. You climb back up, taking " + damage + " damage.";
                    }
                }
            },
            26: {
                text: "You search for another way across the chasm. After some exploration, you find a narrow ice bridge formed by a frozen waterfall.",
                choices: [
                    {text: "Cross the ice bridge", nextSection: 34, skillCheck: true, checkType: 'agility', difficulty: 17}
                ]
            },
            27: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 27, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the Ice Wraith!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            28: {
                text: "The Ice Wraith shatters into a thousand pieces of ice that quickly melt away. Where it stood, a small, glowing crystal remains.",
                choices: [
                    {text: "Take the crystal and continue", nextSection: 35, skillCheck: false}
                ],
                action: function() {
                    addToInventory('Ice Wraith Essence');
                    playSound('item');
                    return "You collect the <span class='item'>Ice Wraith Essence</span>. It pulses with cold energy.";
                }
            },
            29: {
                text: "You attack the Ice Wraith while it's afraid of your fire!",
                choices: [
                    {text: "Fight!", nextSection: 36, skillCheck: false}
                ],
                action: function() {
                    // Combat with advantage due to fire
                    combatState.active = true;
                    combatState.enemyName = "Weakened Ice Wraith";
                    combatState.enemyHealth = 35;
                    combatState.enemyCurrentHealth = 35;
                    combatState.enemyStrength = 14;
                    combatState.nextSection = 28;
                    
                    playSound('combat');
                    return "<span class='ice-wraith'>Weakened Ice Wraith</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            30: {
                text: "The path grows steeper as you approach the old church. It looms ahead, a dark silhouette against the mountain peaks. Flickering lights shine from its broken windows, and you can hear chanting echoing down the mountainside.",
                choices: [
                    {text: "Approach the church main entrance", nextSection: 37, skillCheck: false},
                    {text: "Look for a hidden entrance", nextSection: 38, skillCheck: true, checkType: 'agility', difficulty: 17},
                    {text: "Climb to a higher vantage point", nextSection: 39, skillCheck: false}
                ],
                action: function() {
                    playSound('church');
                    return "The <span class='church'>old church</span> stands as a monument to forgotten faith, now corrupted by Dracula's cult.";
                }
            },
            31: {
                text: "You enter the cave. It's dark and cold, descending deep into the mountain. Torches line the walls, revealing that this is frequently used by the cult.",
                choices: [
                    {text: "Follow the tunnel deeper", nextSection: 40, skillCheck: false},
                    {text: "Return to the surface", nextSection: 30, skillCheck: false}
                ]
            },
            32: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 41, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You successfully navigate the difficult path, approaching the church from an unexpected direction. You find a hidden door at the back of the church, unguarded.";
                    } else {
                        const damage = rollDice(2, 6);
                        gameState.health -= damage;
                        updateStatsDisplay();
                        playSound('damage');
                        return "The path collapses beneath you! You slide down a slope, taking " + damage + " damage.";
                    }
                }
            },
            33: {
                text: "After crossing the bridge, you continue along the mountain path. The church is now clearly visible ahead, perched on a cliff overlooking a deep valley.",
                choices: [
                    {text: "Approach the church", nextSection: 30, skillCheck: false}
                ]
            },
            34: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 42, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You cross the ice bridge carefully. It creaks and groans under your weight but holds. You reach the other side safely.";
                    } else {
                        const damage = rollDice(4, 6);
                        gameState.health -= damage;
                        updateStatsDisplay();
                        playSound('damage');
                        return "The ice bridge cracks and collapses! You fall into the chasm, but manage to grab onto a ledge partway down. You climb out, taking " + damage + " damage.";
                    }
                }
            },
            35: {
                text: "With the Ice Wraith essence in hand, you continue your journey up the mountain.",
                choices: [
                    {text: "Continue toward the church", nextSection: 30, skillCheck: false}
                ]
            },
            36: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 36, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the Ice Wraith!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            37: {
                text: "You approach the main entrance of the church. Two cult guards stand watch, but they haven't noticed you yet.",
                choices: [
                    {text: "Attack the guards", nextSection: 43, skillCheck: false},
                    {text: "Create a distraction", nextSection: 44, skillCheck: true, checkType: 'agility', difficulty: 15}
                ]
            },
            38: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 45, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You find a hidden door behind a collapsed section of wall. It leads into the church basement, away from the main gathering.";
                    } else {
                        playSound('failure');
                        return "You search for a hidden entrance but find nothing. As you return to the front, you're spotted by a guard!";
                        // Force combat
                        setTimeout(() => {
                            loadSection(43);
                        }, 1500);
                        return "";
                    }
                }
            },
            39: {
                text: "You climb to a higher vantage point overlooking the church. From here, you can see inside through broken windows.",
                choices: [
                    {text: "Attack from above", nextSection: 46, skillCheck: true, checkType: 'agility', difficulty: 18},
                    {text: "Descend and enter normally", nextSection: 37, skillCheck: false}
                ]
            },
            40: {
                text: "You follow the tunnel deeper into the mountain. It opens into a large chamber filled with ancient artifacts and relics.",
                choices: [
                    {text: "Search the chamber", nextSection: 47, skillCheck: false},
                    {text: "Return to the church", nextSection: 30, skillCheck: false}
                ]
            },
            41: {
                text: "You reach the hidden door at the back of the church. It's unlocked and leads into a small storage room.",
                choices: [
                    {text: "Enter the church", nextSection: 48, skillCheck: false}
                ]
            },
            42: {
                text: "After crossing the ice bridge, you continue toward the church.",
                choices: [
                    {text: "Approach the church", nextSection: 30, skillCheck: false}
                ]
            },
            43: {
                text: "You attack the guards at the church entrance!",
                choices: [
                    {text: "Fight!", nextSection: 49, skillCheck: false}
                ],
                action: function() {
                    combatState.active = true;
                    combatState.enemyName = "Church Guards";
                    combatState.enemyHealth = 40;
                    combatState.enemyCurrentHealth = 40;
                    combatState.enemyStrength = 16;
                    combatState.nextSection = 50;
                    
                    playSound('combat');
                    return "<span class='enemy'>Church Guards</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            44: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 51, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You create a distraction by throwing rocks away from the church. The guards investigate, leaving the entrance unguarded. You slip inside unnoticed.";
                    } else {
                        playSound('failure');
                        return "Your distraction fails. The guards remain at their posts, now more alert than before.";
                        // Go to attack option
                        setTimeout(() => {
                            loadSection(43);
                        }, 1000);
                        return "";
                    }
                }
            },
            45: {
                text: "You enter the church through the hidden door in the basement. It's dark and musty down here. A stairway leads up to the main chapel.",
                choices: [
                    {text: "Ascend the stairs", nextSection: 48, skillCheck: false}
                ]
            },
            46: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 52, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You attack from above, dropping down onto the altar! You strike before the cultists can react.";
                    } else {
                        playSound('failure');
                        return "You misjudge your jump and land awkwardly, stunning yourself momentarily. The cultists recover quickly!";
                        // Force combat
                        setTimeout(() => {
                            loadSection(53);
                        }, 1500);
                        return "";
                    }
                }
            },
            47: {
                text: "You search the artifact chamber. Among the relics, you find a silver sword that gleams with holy light.",
                choices: [
                    {text: "Take the silver sword", nextSection: 54, skillCheck: false},
                    {text: "Return to the church", nextSection: 30, skillCheck: false}
                ]
            },
            48: {
                text: "From the storage room, you have a clear view of the ritual. The Dark Priest chants over the altar while cultists circle around him.",
                choices: [
                    {text: "Attack from your hidden position", nextSection: 55, skillCheck: false},
                    {text: "Sneak closer to the altar", nextSection: 56, skillCheck: true, checkType: 'agility', difficulty: 17}
                ]
            },
            49: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 49, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the guards!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            50: {
                text: "The guards are defeated. You can now enter the church.",
                choices: [
                    {text: "Enter the church", nextSection: 57, skillCheck: false}
                ],
                action: function() {
                    const goldFound = rollDice(2, 8);
                    gameState.gold += goldFound;
                    updateStatsDisplay();
                    playSound('gold');
                    return "You search the guards and find <span class='gold'>" + goldFound + " Gold</span>.";
                }
            },
            51: {
                text: "You slip inside the church while the guards are distracted. You find yourself just outside the main chapel.",
                choices: [
                    {text: "Enter the main chapel", nextSection: 57, skillCheck: false}
                ]
            },
            52: {
                text: "You drop down from above, landing right in front of the Dark Priest!",
                choices: [
                    {text: "Attack the Dark Priest", nextSection: 58, skillCheck: false}
                ],
                action: function() {
                    playSound('combat');
                    return "The Dark Priest is shocked by your sudden appearance. This is your chance to strike!";
                }
            },
            53: {
                text: "You're surrounded by cultists! You'll have to fight your way out.",
                choices: [
                    {text: "Fight!", nextSection: 59, skillCheck: false}
                ],
                action: function() {
                    combatState.active = true;
                    combatState.enemyName = "Cult of Dracula";
                    combatState.enemyHealth = 80;
                    combatState.enemyCurrentHealth = 80;
                    combatState.enemyStrength = 16;
                    combatState.nextSection = 60;
                    
                    playSound('combat');
                    return "<span class='enemy'>Cult of Dracula</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            54: {
                text: "You take the silver sword. It feels perfectly balanced in your hand, and a warm light emanates from the blade.",
                choices: [
                    {text: "Equip the silver sword", nextSection: 61, skillCheck: false},
                    {text: "Return to the church", nextSection: 30, skillCheck: false}
                ],
                action: function() {
                    addToInventory('Silver Sword');
                    playSound('item');
                    return "The <span class='item'>Silver Sword</span> is a weapon of great power against supernatural creatures.";
                }
            },
            55: {
                text: "You attack from your hidden position in the storage room!",
                choices: [
                    {text: "Fight!", nextSection: 62, skillCheck: false}
                ],
                action: function() {
                    // Combat with surprise advantage
                    combatState.active = true;
                    combatState.enemyName = "Surprised Cultists";
                    combatState.enemyHealth = 70;
                    combatState.enemyCurrentHealth = 70;
                    combatState.enemyStrength = 15;
                    combatState.nextSection = 63;
                    
                    playSound('combat');
                    return "<span class='enemy'>Surprised Cultists</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            56: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 64, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You sneak closer to the altar, staying in the shadows. You're now within striking distance of the Dark Priest.";
                    } else {
                        playSound('failure');
                        return "You're spotted as you try to sneak closer! The cultists turn toward you.";
                        // Force combat
                        setTimeout(() => {
                            loadSection(62);
                        }, 1500);
                        return "";
                    }
                }
            },
            57: {
                text: "You enter the main chapel. The chanting stops abruptly as all eyes turn to you. The Dark Priest smiles, a cruel expression on his pale face.",
                choices: [
                    {text: "Attack the cultists", nextSection: 65, skillCheck: false},
                    {text: "Confront the Dark Priest", nextSection: 66, skillCheck: false}
                ],
                action: function() {
                    playSound('priest');
                    return "<span class='dark-priest'>Dark Priest</span>: 'Ah, the hunter arrives. Just in time for the ritual.'";
                }
            },
            58: {
                text: "You attack the Dark Priest! He raises his hands, dark energy crackling around them.",
                choices: [
                    {text: "Fight!", nextSection: 67, skillCheck: false}
                ],
                action: function() {
                    combatState.active = true;
                    combatState.enemyName = "Dark Priest";
                    combatState.enemyHealth = 60;
                    combatState.enemyCurrentHealth = 60;
                    combatState.enemyStrength = 18;
                    combatState.nextSection = 68;
                    
                    playSound('priest');
                    return "<span class='dark-priest'>Dark Priest</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            59: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 59, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the cultists!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            60: {
                text: "The cultists lie defeated. Only the Dark Priest remains, standing defiantly before the altar.",
                choices: [
                    {text: "Confront the Dark Priest", nextSection: 66, skillCheck: false}
                ]
            },
            61: {
                text: "You equip the silver sword. It feels right in your hand, as if it were made for you.",
                choices: [
                    {text: "Continue to the church", nextSection: 30, skillCheck: false}
                ],
                action: function() {
                    gameState.equippedWeapon = 'Silver Sword';
                    removeFromInventory('Silver Sword');
                    updateInventoryDisplay();
                    playSound('item');
                    return "You now wield the <span class='item'>Silver Sword</span>.";
                }
            },
            62: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 62, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the cultists!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            63: {
                text: "The surprised cultists are defeated. The Dark Priest remains, but his followers are gone.",
                choices: [
                    {text: "Confront the Dark Priest", nextSection: 66, skillCheck: false}
                ]
            },
            64: {
                text: "You're now close to the Dark Priest, hidden in shadows near the altar.",
                choices: [
                    {text: "Attack from hiding", nextSection: 69, skillCheck: false}
                ]
            },
            65: {
                text: "You attack the cultists! There are many of them, but you're prepared for this fight.",
                choices: [
                    {text: "Fight!", nextSection: 70, skillCheck: false}
                ],
                action: function() {
                    combatState.active = true;
                    combatState.enemyName = "Cult of the Dark Priest";
                    combatState.enemyHealth = 80;
                    combatState.enemyCurrentHealth = 80;
                    combatState.enemyStrength = 16;
                    combatState.nextSection = 71;
                    
                    playSound('combat');
                    return "<span class='enemy'>Cult of the Dark Priest</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            66: {
                text: "You stand before the Dark Priest, the last obstacle between you and stopping the ritual.",
                choices: [
                    {text: "Attack the Dark Priest", nextSection: 67, skillCheck: false},
                    {text: "Destroy the ritual altar", nextSection: 72, skillCheck: true, checkType: 'strength', difficulty: 18}
                ]
            },
            67: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 67, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You wounded the Dark Priest!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            68: {
                text: "The Dark Priest falls to his knees, wounded but not defeated.",
                choices: [
                    {text: "Finish him", nextSection: 73, skillCheck: false},
                    {text: "Destroy the ritual components", nextSection: 74, skillCheck: false}
                ]
            },
            69: {
                text: "You attack the Dark Priest from hiding!",
                choices: [
                    {text: "Fight!", nextSection: 75, skillCheck: false}
                ],
                action: function() {
                    // Combat with massive surprise advantage
                    const surpriseDamage = rollDice(3, 8) + 8;
                    
                    combatState.active = true;
                    combatState.enemyName = "Ambushed Dark Priest";
                    combatState.enemyHealth = 60 - surpriseDamage;
                    combatState.enemyCurrentHealth = 60 - surpriseDamage;
                    combatState.enemyStrength = 16;
                    combatState.nextSection = 76;
                    
                    playSound('combat');
                    return "You ambush the Dark Priest for " + surpriseDamage + " damage!<br><br><span class='dark-priest'>Ambushed Dark Priest</span>: Health " + combatState.enemyCurrentHealth + ", Strength " + combatState.enemyStrength;
                }
            },
            70: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 70, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the cultists!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            71: {
                text: "The cultists lie defeated. Only the Dark Priest remains.",
                choices: [
                    {text: "Confront the Dark Priest", nextSection: 66, skillCheck: false}
                ]
            },
            72: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 77, skillCheck: false}
                ],
                action: function() {
                    if (window.checkResult) {
                        playSound('success');
                        return "You smash the ritual altar with your weapon! The dark energy dissipates immediately. The ritual is disrupted!";
                    } else {
                        playSound('failure');
                        return "The altar is protected by dark magic. Your attack has no effect!";
                        setTimeout(() => {
                            loadSection(66);
                        }, 1000);
                        return "";
                    }
                }
            },
            73: {
                text: "You deliver the final blow to the Dark Priest. He collapses, the dark energy around him fading away.",
                choices: [
                    {text: "Search his body", nextSection: 78, skillCheck: false}
                ]
            },
            74: {
                text: "You destroy the ritual components. With each item destroyed, the dark energy in the church weakens.",
                choices: [
                    {text: "Complete Level 3", nextSection: 79, skillCheck: false}
                ],
                action: function() {
                    playSound('success');
                    return "The ritual is completely undone. The church feels lighter, as if a great weight has been lifted.";
                }
            },
            75: {
                text: "",
                choices: [
                    {text: "Attack!", nextSection: 75, skillCheck: false}
                ],
                action: function() {
                    // Execute one round of combat
                    if (combatState.active) {
                        const combatResult = executeCombatRound();
                        
                        // Check if combat is over
                        if (combatState.enemyCurrentHealth <= 0) {
                            combatState.active = false;
                            // Automatically go to victory section after a short delay
                            setTimeout(() => {
                                loadSection(combatState.nextSection);
                            }, 1500);
                            return combatResult + "<br><br><span class='success'>You defeated the Dark Priest!</span>";
                        } else if (gameState.health <= 0) {
                            combatState.active = false;
                            // Game over - will be handled in executeCombatRound
                            return combatResult;
                        }
                        
                        return combatResult;
                    }
                    return "Combat has ended.";
                }
            },
            76: {
                text: "The ambushed Dark Priest falls. Your surprise attack was devastating.",
                choices: [
                    {text: "Deal with the remaining cultists", nextSection: 80, skillCheck: false}
                ]
            },
            77: {
                text: "With the ritual destroyed, the dark energy dissipates.",
                choices: [
                    {text: "Deal with the Dark Priest", nextSection: 81, skillCheck: false}
                ]
            },
            78: {
                text: "You search the Dark Priest's body. You find his journal, a map to Dracula's castle, and a strange amulet.",
                choices: [
                    {text: "Take the items", nextSection: 82, skillCheck: false}
                ]
            },
            79: {
                text: "",
                choices: [
                    {text: "Continue", nextSection: 83, skillCheck: false}
                ],
                action: function() {
                    // Show complete screen
                    showCompleteScreen();
                    return "";
                }
            },
            80: {
                text: "With their leader dead, the remaining cultists either flee or surrender.",
                choices: [
                    {text: "Complete Level 3", nextSection: 79, skillCheck: false}
                ]
            },
            81: {
                text: "With the ritual destroyed, the Dark Priest's power is broken.",
                choices: [
                    {text: "Finish him", nextSection: 73, skillCheck: false}
                ]
            },
            82: {
                text: "You take the Dark Priest's belongings. The journal contains valuable information about Dracula's plans.",
                choices: [
                    {text: "Complete Level 3", nextSection: 79, skillCheck: false}
                ],
                action: function() {
                    addToInventory("Dark Priest's Notes");
                    addToInventory("Castle Dracula Map");
                    playSound('item');
                    return "You acquire <span class='item'>Dark Priest's Notes</span> and a <span class='item'>Castle Dracula Map</span>.";
                }
            },
            83: {
                text: "",
                choices: []
            }
        };
        
        // Load story section
        function loadSection(sectionId) {
            playSound('click');
            gameState.currentSection = sectionId;
            const section = storySections[sectionId];
            
            if (!section) {
                document.getElementById('story-text').innerHTML = "<p class='game-over'>Error: Story section not found!</p>";
                return;
            }
            
            let storyText = section.text;
            
            // Execute any section action
            if (section.action) {
                const actionResult = section.action();
                if (actionResult) {
                    storyText += "<br><br>" + actionResult;
                }
            }
            
            document.getElementById('story-text').innerHTML = "<p>" + storyText + "</p><div class='blinking-cursor'></div>";
            
            // Clear choice buttons
            const choiceButtons = document.getElementById('choice-buttons');
            choiceButtons.innerHTML = '';
            
            // If in combat, show attack button
            if (combatState.active && (
                sectionId === 23 || sectionId === 27 || sectionId === 36 || 
                sectionId === 49 || sectionId === 59 || sectionId === 62 || 
                sectionId === 67 || sectionId === 70 || sectionId === 75
            )) {
                const attackButton = document.createElement('button');
                attackButton.className = 'choice-btn';
                attackButton.textContent = "Attack!";
                attackButton.onclick = function() {
                    loadSection(sectionId);
                };
                choiceButtons.appendChild(attackButton);
                return;
            }
            
            // Filter choices based on requirements
            const availableChoices = section.choices.filter(choice => {
                if (!choice.requirement) return true;
                if (typeof choice.requirement === 'function') {
                    return choice.requirement();
                }
                return gameState.inventory.includes(choice.requirement) || 
                       gameState.equippedWeapon === choice.requirement ||
                       gameState.equippedArmor === choice.requirement;
            });
            
            // If no choices available (and not a special section), provide a default
            if (availableChoices.length === 0 && section.choices.length > 0) {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = "Continue";
                button.onclick = function() {
                    loadSection(1);
                };
                choiceButtons.appendChild(button);
            } else {
                availableChoices.forEach(choice => {
                    const button = document.createElement('button');
                    button.className = 'choice-btn';
                    button.textContent = choice.text;
                    button.onclick = function() {
                        if (choice.skillCheck) {
                            performSkillCheck(choice.checkType, choice.difficulty, choice.nextSection);
                        } else {
                            loadSection(choice.nextSection);
                        }
                    };
                    choiceButtons.appendChild(button);
                });
            }
            
            // Save game progress
            saveGame();
        }
        
        // Execute one round of combat
        function executeCombatRound() {
            // Roll dice for both combatants
            const playerRoll = rollDice(2, 6);
            const enemyRoll = rollDice(2, 6);
            
            // Add strength to dice rolls
            const playerTotal = playerRoll + gameState.strength;
            const enemyTotal = enemyRoll + combatState.enemyStrength;
            
            let resultText = `<div class="combat-log"><span class="enemy">${combatState.enemyName}</span><br>`;
            resultText += `Your Health: ${gameState.health}/${gameState.maxHealth}, Enemy Health: ${combatState.enemyCurrentHealth}<br>`;
            resultText += `You roll ${playerRoll} + Strength ${gameState.strength} = <strong>${playerTotal}</strong><br>`;
            resultText += `Enemy rolls ${enemyRoll} + Strength ${combatState.enemyStrength} = <strong>${enemyTotal}</strong><br>`;
            
            if (playerTotal > enemyTotal) {
                // Player hits enemy
                let damage = 0;
                let weaponType = gameState.equippedWeapon;
                
                // Weapon bonuses
                if (weaponType === 'Steel Sword') {
                    damage = rollDice(2, 8) + 3;
                } else if (weaponType === 'Silver Sword') {
                    damage = rollDice(3, 8) + 5;
                } else {
                    damage = rollDice(1, 6);
                }
                
                combatState.enemyCurrentHealth -= damage;
                resultText += `<span class="success">You hit for ${damage} damage!</span><br>`;
                playSound('combat');
                
            } else if (playerTotal < enemyTotal) {
                // Enemy hits player
                let enemyDamage = rollDice(2, 6);
                
                gameState.health -= enemyDamage;
                resultText += `<span class="damage">The ${combatState.enemyName} hits you for ${enemyDamage} damage!</span>`;
                playSound('damage');
                
            } else {
                // Tie - no damage dealt
                resultText += "The attacks are evenly matched! No damage dealt this round.";
            }
            
            resultText += `</div>`;
            updateStatsDisplay();
            
            // Check for player death
            if (gameState.health <= 0) {
                resultText += `<div class="game-over">YOU HAVE DIED</div>`;
                resultText += `<div class="dice-roll"><button onclick="window.location.href='le3.html'" class="action-btn">Restart Level 3</button></div>`;
                combatState.active = false;
            }
            
            return resultText;
        }
        
        // Show complete screen
        function showCompleteScreen() {
            // Update complete screen stats
            document.getElementById('complete-stat-strength').textContent = gameState.strength;
            document.getElementById('complete-stat-health').textContent = gameState.health;
            document.getElementById('complete-stat-agility').textContent = gameState.agility;
            document.getElementById('complete-stat-gold').textContent = gameState.gold;
            
            playSound('victory');
            document.getElementById('screen-game').classList.remove('active-screen');
            document.getElementById('screen-complete').classList.add('active-screen');
            
            // Save completed game state
            gameState.level3Complete = true;
            saveGame();
        }
        
        // Go to next level
        function goToNextLevel() {
            playSound('click');
            // Save game state for level 4
            gameState.level = 4;
            gameState.currentSection = 1;
            saveGame();
            
            // Redirect to level 4
            window.location.href = 'le4.html';
        }
        
        // Perform skill check
        function performSkillCheck(checkType, difficulty, nextSection) {
            playSound('roll');
            const diceRoll = rollDice(2, 6);
            let statValue = gameState[checkType];
            let success = diceRoll <= statValue;
            
            // Store result globally for section actions to use
            window.checkResult = success;
            
            let resultText = `You roll ${diceRoll}. Your ${checkType.toUpperCase()} is ${statValue}. `;
            resultText += success ? 
                `<span class="success">Success!</span>` : 
                `<span class="damage">Failure!</span>`;
            
            document.getElementById('story-text').innerHTML += `<div class="dice-roll">${resultText}</div>`;
            
            if (success) {
                playSound('success');
            } else {
                playSound('failure');
            }
            
            // Continue to next section after a brief delay
            setTimeout(() => {
                loadSection(nextSection);
            }, 1500);
        }
        
        // Use Agility
        function useAgility() {
            playSound('click');
            if (gameState.agility <= 0) {
                document.getElementById('story-text').innerHTML += `<div class="dice-roll">You have no Agility!</div>`;
                return;
            }
            
            const diceRoll = rollDice(2, 6);
            const success = diceRoll <= gameState.agility;
            
            let resultText = `You use your agility... Roll: ${diceRoll}, Agility: ${gameState.agility}. `;
            resultText += success ? 
                `<span class="success">Agile!</span> You move with grace and speed.` : 
                `<span class="damage">Clumsy!</span> You fumble.`;
            
            document.getElementById('story-text').innerHTML += `<div class="dice-roll">${resultText}</div>`;
            
            if (success) {
                playSound('success');
                const effect = "You scale a difficult cliff with ease!";
                document.getElementById('story-text').innerHTML += `<div class="dice-roll">${effect}</div>`;
            } else {
                playSound('failure');
                const effect = "You slip on ice and take 5 damage!";
                document.getElementById('story-text').innerHTML += `<div class="dice-roll">${effect}</div>`;
                gameState.health -= 5;
                updateStatsDisplay();
                playSound('damage');
            }
        }
        
        // Save game
        function saveGame() {
            playSound('click');
            localStorage.setItem('draculaGameState', JSON.stringify(gameState));
            document.getElementById('story-text').innerHTML += `<div class="dice-roll"><span class="success">Game saved!</span></div>`;
        }
        
        // Load game
        function loadGame() {
            playSound('click');
            const savedGame = localStorage.getItem('draculaGameState');
            if (savedGame) {
                const savedState = JSON.parse(savedGame);
                
                // Only load if saved level is 3 (this page)
                if (savedState.level === 3) {
                    Object.assign(gameState, savedState);
                    
                    updateStatsDisplay();
                    updateInventoryDisplay();
                    loadSection(gameState.currentSection);
                    
                    document.getElementById('story-text').innerHTML += `<div class="dice-roll"><span class="success">Game loaded!</span></div>`;
                } else {
                    document.getElementById('story-text').innerHTML += `<div class="dice-roll">No saved game found for Level 3.</div>`;
                }
            } else {
                document.getElementById('story-text').innerHTML += `<div class="dice-roll">No saved game found.</div>`;
            }
        }
        
        // Utility function to roll dice
        function rollDice(num, sides) {
            let total = 0;
            for (let i = 0; i < num; i++) {
                total += Math.floor(Math.random() * sides) + 1;
            }
            return total;
        }
        
        // Initialize on load
        window.onload = initGame;
        
        // Add click sound to all buttons
        document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    playSound('click');
                });
            });
        });
    </script>
</body>
</html>
